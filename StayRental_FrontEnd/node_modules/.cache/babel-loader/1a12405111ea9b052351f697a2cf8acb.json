{"ast":null,"code":"import _objectSpread from\"/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{Form,Input,InputNumber,Button,message}from\"antd\";import{uploadStay}from\"../utils\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var layout={labelCol:{span:8},wrapperCol:{span:16}};var UploadStay=/*#__PURE__*/function(_React$Component){_inherits(UploadStay,_React$Component);var _super=_createSuper(UploadStay);function UploadStay(){var _this;_classCallCheck(this,UploadStay);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={loading:false};_this.fileInputRef=/*#__PURE__*/React.createRef();_this.handleSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(values){var formData,files,i;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:formData=new FormData();files=_this.fileInputRef.current.files;//检查是否传的文件超过五个\nif(!(files.length>5)){_context.next=5;break;}message.error(\"You can at most upload 5 pictures.\");return _context.abrupt(\"return\");case 5://将酒店图片append到form data上\nfor(i=0;i<files.length;i++){formData.append(\"images\",files[i]);}//将上传文件的用户信息append到form data上\nformData.append(\"name\",values.name);formData.append(\"address\",values.address);formData.append(\"description\",values.description);formData.append(\"guest_number\",values.guest_number);_this.setState({loading:true});_context.prev=11;_context.next=14;return uploadStay(formData);case 14:message.success(\"upload successfully\");_context.next=20;break;case 17:_context.prev=17;_context.t0=_context[\"catch\"](11);message.error(_context.t0.message);case 20:_context.prev=20;_this.setState({loading:false});return _context.finish(20);case 23:case\"end\":return _context.stop();}}},_callee,null,[[11,17,20,23]]);}));return function(_x){return _ref.apply(this,arguments);};}();return _this;}_createClass(UploadStay,[{key:\"render\",value:function render(){// {...layout} spread 语法，把layout这个object里的内容，\n// 一对一对作为key value pair传入form\n// <Form {...layout}></Form> 等价于 <Form lableCol = {} wrapper= {}> </From>\n//name是property的名字，label是在ui上显示的字样\nreturn/*#__PURE__*/_jsxs(Form,_objectSpread(_objectSpread({},layout),{},{name:\"nest-messages\",onFinish:this.handleSubmit,style:{maxWidth:1000,margin:\"auto\"},children:[/*#__PURE__*/_jsx(Form.Item,{name:\"name\",label:\"Name\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"address\",label:\"Address\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"description\",label:\"Description\",rules:[{required:true}],children:/*#__PURE__*/_jsx(Input.TextArea,{autoSize:{minRows:2,maxRows:6}})}),/*#__PURE__*/_jsx(Form.Item,{name:\"guest_number\",label:\"Guest Number\",rules:[{required:true,type:\"number\",min:1}],children:/*#__PURE__*/_jsx(InputNumber,{})}),/*#__PURE__*/_jsx(Form.Item,{name:\"picture\",label:\"Picture\",rules:[{required:true}],children:/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/png, image/jpeg\",ref:this.fileInputRef,multiple:true})}),/*#__PURE__*/_jsx(Form.Item,{wrapperCol:_objectSpread(_objectSpread({},layout.wrapperCol),{},{offset:8}),children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",loading:this.state.loading,children:\"Submit\"})})]}));}}]);return UploadStay;}(React.Component);export default UploadStay;","map":{"version":3,"sources":["/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/src/components/UploadStay.js"],"names":["React","Form","Input","InputNumber","Button","message","uploadStay","layout","labelCol","span","wrapperCol","UploadStay","state","loading","fileInputRef","createRef","handleSubmit","values","formData","FormData","files","current","length","error","i","append","name","address","description","guest_number","setState","success","maxWidth","margin","required","minRows","maxRows","type","min","offset","Component"],"mappings":"kwCAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAASC,IAAT,CAAeC,KAAf,CAAsBC,WAAtB,CAAmCC,MAAnC,CAA2CC,OAA3C,KAA0D,MAA1D,CACA,OAASC,UAAT,KAA2B,UAA3B,C,wFAEA,GAAMC,CAAAA,MAAM,CAAG,CACXC,QAAQ,CAAE,CAAEC,IAAI,CAAE,CAAR,CADC,CAEXC,UAAU,CAAE,CAAED,IAAI,CAAE,EAAR,CAFD,CAAf,C,GAKME,CAAAA,U,uVACFC,K,CAAQ,CACJC,OAAO,CAAE,KADL,C,OAIRC,Y,cAAed,KAAK,CAACe,SAAN,E,OAEfC,Y,0FAAe,iBAAOC,MAAP,uIACLC,QADK,CACM,GAAIC,CAAAA,QAAJ,EADN,CAEHC,KAFG,CAEO,MAAKN,YAAL,CAAkBO,OAFzB,CAEHD,KAFG,CAIZ;AAJY,KAKPA,KAAK,CAACE,MAAN,CAAe,CALR,0BAMPjB,OAAO,CAACkB,KAAR,CAAc,oCAAd,EANO,wCAUX;AACA,IAASC,CAAT,CAAa,CAAb,CAAgBA,CAAC,CAAGJ,KAAK,CAACE,MAA1B,CAAkCE,CAAC,EAAnC,CAAuC,CACnCN,QAAQ,CAACO,MAAT,CAAgB,QAAhB,CAA0BL,KAAK,CAACI,CAAD,CAA/B,EACH,CAED;AACAN,QAAQ,CAACO,MAAT,CAAgB,MAAhB,CAAwBR,MAAM,CAACS,IAA/B,EACAR,QAAQ,CAACO,MAAT,CAAgB,SAAhB,CAA2BR,MAAM,CAACU,OAAlC,EACAT,QAAQ,CAACO,MAAT,CAAgB,aAAhB,CAA+BR,MAAM,CAACW,WAAtC,EACAV,QAAQ,CAACO,MAAT,CAAgB,cAAhB,CAAgCR,MAAM,CAACY,YAAvC,EAEA,MAAKC,QAAL,CAAc,CACVjB,OAAO,CAAE,IADC,CAAd,EArBW,wCAyBDP,CAAAA,UAAU,CAACY,QAAD,CAzBT,SA0BPb,OAAO,CAAC0B,OAAR,CAAgB,qBAAhB,EA1BO,kFA4BP1B,OAAO,CAACkB,KAAR,CAAc,YAAMlB,OAApB,EA5BO,yBA8BP,MAAKyB,QAAL,CAAc,CACVjB,OAAO,CAAE,KADC,CAAd,EA9BO,uG,0HAoCf,iBAAS,CACL;AACA;AACA;AAEA;AACA,mBACI,MAAC,IAAD,gCACQN,MADR,MAEI,IAAI,CAAC,eAFT,CAGI,QAAQ,CAAE,KAAKS,YAHnB,CAII,KAAK,CAAE,CAAEgB,QAAQ,CAAE,IAAZ,CAAkBC,MAAM,CAAE,MAA1B,CAJX,wBAMI,KAAC,IAAD,CAAM,IAAN,EAAW,IAAI,CAAC,MAAhB,CAAuB,KAAK,CAAC,MAA7B,CAAoC,KAAK,CAAE,CAAC,CAAEC,QAAQ,CAAE,IAAZ,CAAD,CAA3C,uBACI,KAAC,KAAD,IADJ,EANJ,cASI,KAAC,IAAD,CAAM,IAAN,EAAW,IAAI,CAAC,SAAhB,CAA0B,KAAK,CAAC,SAAhC,CAA0C,KAAK,CAAE,CAAC,CAAEA,QAAQ,CAAE,IAAZ,CAAD,CAAjD,uBACI,KAAC,KAAD,IADJ,EATJ,cAYI,KAAC,IAAD,CAAM,IAAN,EACI,IAAI,CAAC,aADT,CAEI,KAAK,CAAC,aAFV,CAGI,KAAK,CAAE,CAAC,CAAEA,QAAQ,CAAE,IAAZ,CAAD,CAHX,uBAKI,KAAC,KAAD,CAAO,QAAP,EAAgB,QAAQ,CAAE,CAAEC,OAAO,CAAE,CAAX,CAAcC,OAAO,CAAE,CAAvB,CAA1B,EALJ,EAZJ,cAmBI,KAAC,IAAD,CAAM,IAAN,EACI,IAAI,CAAC,cADT,CAEI,KAAK,CAAC,cAFV,CAGI,KAAK,CAAE,CAAC,CAAEF,QAAQ,CAAE,IAAZ,CAAkBG,IAAI,CAAE,QAAxB,CAAkCC,GAAG,CAAE,CAAvC,CAAD,CAHX,uBAKI,KAAC,WAAD,IALJ,EAnBJ,cA6BI,KAAC,IAAD,CAAM,IAAN,EAAW,IAAI,CAAC,SAAhB,CAA0B,KAAK,CAAC,SAAhC,CAA0C,KAAK,CAAE,CAAC,CAAEJ,QAAQ,CAAE,IAAZ,CAAD,CAAjD,uBACI,cACI,IAAI,CAAC,MADT,CAEI,MAAM,CAAC,uBAFX,CAGI,GAAG,CAAE,KAAKpB,YAHd,CAII,QAAQ,CAAE,IAJd,EADJ,EA7BJ,cAqCI,KAAC,IAAD,CAAM,IAAN,EAAW,UAAU,gCAAOP,MAAM,CAACG,UAAd,MAA0B6B,MAAM,CAAE,CAAlC,EAArB,uBACI,KAAC,MAAD,EAAQ,IAAI,CAAC,SAAb,CAAuB,QAAQ,CAAC,QAAhC,CAAyC,OAAO,CAAE,KAAK3B,KAAL,CAAWC,OAA7D,oBADJ,EArCJ,IADJ,CA6CH,C,wBA9FoBb,KAAK,CAACwC,S,EAiG/B,cAAe7B,CAAAA,UAAf","sourcesContent":["import React from \"react\";\nimport { Form, Input, InputNumber, Button, message } from \"antd\";\nimport { uploadStay } from \"../utils\";\n\nconst layout = {\n    labelCol: { span: 8 },\n    wrapperCol: { span: 16 },\n};\n\nclass UploadStay extends React.Component {\n    state = {\n        loading: false,\n    };\n\n    fileInputRef = React.createRef();\n\n    handleSubmit = async (values) => {\n        const formData = new FormData();\n        const { files } = this.fileInputRef.current;\n\n       //检查是否传的文件超过五个\n        if (files.length > 5) {\n            message.error(\"You can at most upload 5 pictures.\");\n            return;\n        }\n\n        //将酒店图片append到form data上\n        for (let i = 0; i < files.length; i++) {\n            formData.append(\"images\", files[i]);\n        }\n\n        //将上传文件的用户信息append到form data上\n        formData.append(\"name\", values.name);\n        formData.append(\"address\", values.address);\n        formData.append(\"description\", values.description);\n        formData.append(\"guest_number\", values.guest_number);\n\n        this.setState({\n            loading: true,\n        });\n        try {\n            await uploadStay(formData);\n            message.success(\"upload successfully\");\n        } catch (error) {\n            message.error(error.message);\n        } finally {\n            this.setState({\n                loading: false,\n            });\n        }\n    };\n\n    render() {\n        // {...layout} spread 语法，把layout这个object里的内容，\n        // 一对一对作为key value pair传入form\n        // <Form {...layout}></Form> 等价于 <Form lableCol = {} wrapper= {}> </From>\n\n        //name是property的名字，label是在ui上显示的字样\n        return (\n            <Form\n                {...layout}\n                name=\"nest-messages\"\n                onFinish={this.handleSubmit}\n                style={{ maxWidth: 1000, margin: \"auto\" }}\n            >\n                <Form.Item name=\"name\" label=\"Name\" rules={[{ required: true }]}>\n                    <Input />\n                </Form.Item>\n                <Form.Item name=\"address\" label=\"Address\" rules={[{ required: true }]}>\n                    <Input />\n                </Form.Item>\n                <Form.Item\n                    name=\"description\"\n                    label=\"Description\"\n                    rules={[{ required: true }]}\n                >\n                    <Input.TextArea autoSize={{ minRows: 2, maxRows: 6 }} />\n                </Form.Item>\n                <Form.Item\n                    name=\"guest_number\"\n                    label=\"Guest Number\"\n                    rules={[{ required: true, type: \"number\", min: 1 }]}\n                >\n                    <InputNumber />\n                </Form.Item>\n                {/*\n                  accept=\"image/png, image/jpeg\" 确定接受的文件格式\n                  */}\n                <Form.Item name=\"picture\" label=\"Picture\" rules={[{ required: true }]}>\n                    <input\n                        type=\"file\"\n                        accept=\"image/png, image/jpeg\"\n                        ref={this.fileInputRef}\n                        multiple={true}\n                    />\n                </Form.Item>\n                <Form.Item wrapperCol={{ ...layout.wrapperCol, offset: 8 }}>\n                    <Button type=\"primary\" htmlType=\"submit\" loading={this.state.loading}>\n                        Submit\n                    </Button>\n                </Form.Item>\n            </Form>\n        );\n    }\n}\n\nexport default UploadStay;\n"]},"metadata":{},"sourceType":"module"}