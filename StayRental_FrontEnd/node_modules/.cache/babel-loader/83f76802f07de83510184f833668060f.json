{"ast":null,"code":"var domain=\"http://onyx-nexus-326722.de.r.appspot.com\";// body: JSON.stringify(credential) 将登陆信息转换成json格式的string\nexport var login=function login(credential,asHost){var loginUrl=\"\".concat(domain,\"/authenticate/\").concat(asHost?\"host\":\"guest\");return fetch(loginUrl,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(credential)}).then(function(response){if(response.status!==200){throw Error(\"Fail to log in\");}return response.json();});};export var register=function register(credential,asHost){var registerUrl=\"\".concat(domain,\"/register/\").concat(asHost?\"host\":\"guest\");return fetch(registerUrl,{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(credential)}).then(function(response){if(response.status!==200){throw Error(\"Fail to register\");}});};export var getReservations=function getReservations(){//local storage 浏览器提供的object\nvar authToken=localStorage.getItem(\"authToken\");var listReservationsUrl=\"\".concat(domain,\"/reservations\");return fetch(listReservationsUrl,{headers:{Authorization:\"Bearer \".concat(authToken)}}).then(function(response){if(response.status!==200){throw Error(\"Fail to get reservation list\");}return response.json();});};// authz authorization:进入后是什么角色\n// authn authentication: 登陆\nexport var getStaysByHost=function getStaysByHost(){var authToken=localStorage.getItem(\"authToken\");var listStaysUrl=\"\".concat(domain,\"/stays/\");return fetch(listStaysUrl,{headers:{Authorization:\"Bearer \".concat(authToken)}}).then(function(response){if(response.status!==200){throw Error(\"Fail to get stay list\");}return response.json();});};export var searchStays=function searchStays(query){var authToken=localStorage.getItem(\"authToken\");var searchStaysUrl=new URL(\"\".concat(domain,\"/search/\"));//统一后端格式\n//如何往url上安全地增加query string的内容\n//protocol://domain:port/path?querystring#hashtag\nsearchStaysUrl.searchParams.append(\"guest_number\",query.guest_number);//format <DataPicker />所传的数据\nsearchStaysUrl.searchParams.append(\"checkin_date\",query.checkin_date.format(\"YYYY-MM-DD\"));searchStaysUrl.searchParams.append(\"checkout_date\",query.checkout_date.format(\"YYYY-MM-DD\"));searchStaysUrl.searchParams.append(\"lat\",37);searchStaysUrl.searchParams.append(\"lon\",-122);return fetch(searchStaysUrl,{headers:{Authorization:\"Bearer \".concat(authToken)}}).then(function(response){if(response.status!==200){throw Error(\"Fail to search stays\");}return response.json();});};export var deleteStay=function deleteStay(stayId){var authToken=localStorage.getItem(\"authToken\");var deleteStayUrl=\"\".concat(domain,\"/stays/\").concat(stayId);return fetch(deleteStayUrl,{method:\"DELETE\",headers:{Authorization:\"Bearer \".concat(authToken)}}).then(function(response){if(response.status!==200){throw Error(\"Fail to delete stay\");}});};export var bookStay=function bookStay(data){var authToken=localStorage.getItem(\"authToken\");var bookStayUrl=\"\".concat(domain,\"/reservations\");return fetch(bookStayUrl,{method:\"POST\",headers:{Authorization:\"Bearer \".concat(authToken),\"Content-Type\":\"application/json\"},body:JSON.stringify(data)}).then(function(response){if(response.status!==200){throw Error(\"Fail to book reservation\");}});};export var cancelReservation=function cancelReservation(reservationId){var authToken=localStorage.getItem(\"authToken\");var cancelReservationUrl=\"\".concat(domain,\"/reservations/\").concat(reservationId);return fetch(cancelReservationUrl,{method:\"DELETE\",headers:{Authorization:\"Bearer \".concat(authToken)}}).then(function(response){if(response.status!==200){throw Error(\"Fail to cancel reservation\");}});};export var getReservationsByStay=function getReservationsByStay(stayId){var authToken=localStorage.getItem(\"authToken\");var getReservationByStayUrl=\"\".concat(domain,\"/stays/reservations/\").concat(stayId);return fetch(getReservationByStayUrl,{headers:{Authorization:\"Bearer \".concat(authToken)}}).then(function(response){if(response.status!==200){throw Error(\"Fail to get reservations by stay\");}return response.json();});};export var uploadStay=function uploadStay(data){var authToken=localStorage.getItem(\"authToken\");var uploadStayUrl=\"\".concat(domain,\"/stays\");return fetch(uploadStayUrl,{method:\"POST\",headers:{Authorization:\"Bearer \".concat(authToken)},body:data}).then(function(response){if(response.status!==200){throw Error(\"Fail to upload stay\");}});};","map":{"version":3,"sources":["/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/src/utils.js"],"names":["domain","login","credential","asHost","loginUrl","fetch","method","headers","body","JSON","stringify","then","response","status","Error","json","register","registerUrl","getReservations","authToken","localStorage","getItem","listReservationsUrl","Authorization","getStaysByHost","listStaysUrl","searchStays","query","searchStaysUrl","URL","searchParams","append","guest_number","checkin_date","format","checkout_date","deleteStay","stayId","deleteStayUrl","bookStay","data","bookStayUrl","cancelReservation","reservationId","cancelReservationUrl","getReservationsByStay","getReservationByStayUrl","uploadStay","uploadStayUrl"],"mappings":"AAAA,GAAMA,CAAAA,MAAM,CAAG,2CAAf,CAEA;AAEA,MAAO,IAAMC,CAAAA,KAAK,CAAG,QAARA,CAAAA,KAAQ,CAACC,UAAD,CAAaC,MAAb,CAAwB,CACzC,GAAMC,CAAAA,QAAQ,WAAMJ,MAAN,0BAA6BG,MAAM,CAAG,MAAH,CAAY,OAA/C,CAAd,CACA,MAAOE,CAAAA,KAAK,CAACD,QAAD,CAAW,CACnBE,MAAM,CAAE,MADW,CAEnBC,OAAO,CAAE,CACL,eAAgB,kBADX,CAFU,CAKnBC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeR,UAAf,CALa,CAAX,CAAL,CAMJS,IANI,CAMC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,gBAAD,CAAX,CACH,CAED,MAAOF,CAAAA,QAAQ,CAACG,IAAT,EAAP,CACH,CAZM,CAAP,CAaH,CAfM,CAiBP,MAAO,IAAMC,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACd,UAAD,CAAaC,MAAb,CAAwB,CAC5C,GAAMc,CAAAA,WAAW,WAAMjB,MAAN,sBAAyBG,MAAM,CAAG,MAAH,CAAY,OAA3C,CAAjB,CACA,MAAOE,CAAAA,KAAK,CAACY,WAAD,CAAc,CACtBX,MAAM,CAAE,MADc,CAEtBC,OAAO,CAAE,CACL,eAAgB,kBADX,CAFa,CAKtBC,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAeR,UAAf,CALgB,CAAd,CAAL,CAMJS,IANI,CAMC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,kBAAD,CAAX,CACH,CACJ,CAVM,CAAP,CAWH,CAbM,CAeP,MAAO,IAAMI,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CACjC;AACA,GAAMC,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB,CACA,GAAMC,CAAAA,mBAAmB,WAAMtB,MAAN,iBAAzB,CAEA,MAAOK,CAAAA,KAAK,CAACiB,mBAAD,CAAsB,CAC9Bf,OAAO,CAAE,CACLgB,aAAa,kBAAYJ,SAAZ,CADR,CADqB,CAAtB,CAAL,CAIJR,IAJI,CAIC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,8BAAD,CAAX,CACH,CAED,MAAOF,CAAAA,QAAQ,CAACG,IAAT,EAAP,CACH,CAVM,CAAP,CAWH,CAhBM,CAiBP;AACA;AACA,MAAO,IAAMS,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAChC,GAAML,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB,CACA,GAAMI,CAAAA,YAAY,WAAMzB,MAAN,WAAlB,CAEA,MAAOK,CAAAA,KAAK,CAACoB,YAAD,CAAe,CACvBlB,OAAO,CAAE,CACLgB,aAAa,kBAAYJ,SAAZ,CADR,CADc,CAAf,CAAL,CAIJR,IAJI,CAIC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,uBAAD,CAAX,CACH,CAED,MAAOF,CAAAA,QAAQ,CAACG,IAAT,EAAP,CACH,CAVM,CAAP,CAWH,CAfM,CAiBP,MAAO,IAAMW,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACC,KAAD,CAAW,CAClC,GAAMR,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB,CACA,GAAMO,CAAAA,cAAc,CAAG,GAAIC,CAAAA,GAAJ,WAAW7B,MAAX,aAAvB,CACA;AACA;AACA;AACA4B,cAAc,CAACE,YAAf,CAA4BC,MAA5B,CAAmC,cAAnC,CAAmDJ,KAAK,CAACK,YAAzD,EACA;AACAJ,cAAc,CAACE,YAAf,CAA4BC,MAA5B,CACI,cADJ,CAEIJ,KAAK,CAACM,YAAN,CAAmBC,MAAnB,CAA0B,YAA1B,CAFJ,EAIAN,cAAc,CAACE,YAAf,CAA4BC,MAA5B,CACI,eADJ,CAEIJ,KAAK,CAACQ,aAAN,CAAoBD,MAApB,CAA2B,YAA3B,CAFJ,EAIAN,cAAc,CAACE,YAAf,CAA4BC,MAA5B,CAAmC,KAAnC,CAA0C,EAA1C,EACAH,cAAc,CAACE,YAAf,CAA4BC,MAA5B,CAAmC,KAAnC,CAA0C,CAAC,GAA3C,EAEA,MAAO1B,CAAAA,KAAK,CAACuB,cAAD,CAAiB,CACzBrB,OAAO,CAAE,CACLgB,aAAa,kBAAYJ,SAAZ,CADR,CADgB,CAAjB,CAAL,CAIJR,IAJI,CAIC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,sBAAD,CAAX,CACH,CAED,MAAOF,CAAAA,QAAQ,CAACG,IAAT,EAAP,CACH,CAVM,CAAP,CAWH,CA9BM,CAgCP,MAAO,IAAMqB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACC,MAAD,CAAY,CAClC,GAAMlB,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB,CACA,GAAMiB,CAAAA,aAAa,WAAMtC,MAAN,mBAAsBqC,MAAtB,CAAnB,CAEA,MAAOhC,CAAAA,KAAK,CAACiC,aAAD,CAAgB,CACxBhC,MAAM,CAAE,QADgB,CAExBC,OAAO,CAAE,CACLgB,aAAa,kBAAYJ,SAAZ,CADR,CAFe,CAAhB,CAAL,CAKJR,IALI,CAKC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,qBAAD,CAAX,CACH,CACJ,CATM,CAAP,CAUH,CAdM,CAgBP,MAAO,IAAMyB,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,CAACC,IAAD,CAAU,CAC9B,GAAMrB,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB,CACA,GAAMoB,CAAAA,WAAW,WAAMzC,MAAN,iBAAjB,CAEA,MAAOK,CAAAA,KAAK,CAACoC,WAAD,CAAc,CACtBnC,MAAM,CAAE,MADc,CAEtBC,OAAO,CAAE,CACLgB,aAAa,kBAAYJ,SAAZ,CADR,CAEL,eAAgB,kBAFX,CAFa,CAMtBX,IAAI,CAAEC,IAAI,CAACC,SAAL,CAAe8B,IAAf,CANgB,CAAd,CAAL,CAOJ7B,IAPI,CAOC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,0BAAD,CAAX,CACH,CACJ,CAXM,CAAP,CAYH,CAhBM,CAkBP,MAAO,IAAM4B,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACC,aAAD,CAAmB,CAChD,GAAMxB,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB,CACA,GAAMuB,CAAAA,oBAAoB,WAAM5C,MAAN,0BAA6B2C,aAA7B,CAA1B,CAEA,MAAOtC,CAAAA,KAAK,CAACuC,oBAAD,CAAuB,CAC/BtC,MAAM,CAAE,QADuB,CAE/BC,OAAO,CAAE,CACLgB,aAAa,kBAAYJ,SAAZ,CADR,CAFsB,CAAvB,CAAL,CAKJR,IALI,CAKC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,4BAAD,CAAX,CACH,CACJ,CATM,CAAP,CAUH,CAdM,CAgBP,MAAO,IAAM+B,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,CAACR,MAAD,CAAY,CAC7C,GAAMlB,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB,CACA,GAAMyB,CAAAA,uBAAuB,WAAM9C,MAAN,gCAAmCqC,MAAnC,CAA7B,CAEA,MAAOhC,CAAAA,KAAK,CAACyC,uBAAD,CAA0B,CAClCvC,OAAO,CAAE,CACLgB,aAAa,kBAAYJ,SAAZ,CADR,CADyB,CAA1B,CAAL,CAIJR,IAJI,CAIC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,kCAAD,CAAX,CACH,CAED,MAAOF,CAAAA,QAAQ,CAACG,IAAT,EAAP,CACH,CAVM,CAAP,CAWH,CAfM,CAiBP,MAAO,IAAMgC,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACP,IAAD,CAAU,CAChC,GAAMrB,CAAAA,SAAS,CAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAAlB,CACA,GAAM2B,CAAAA,aAAa,WAAMhD,MAAN,UAAnB,CAEA,MAAOK,CAAAA,KAAK,CAAC2C,aAAD,CAAgB,CACxB1C,MAAM,CAAE,MADgB,CAExBC,OAAO,CAAE,CACLgB,aAAa,kBAAYJ,SAAZ,CADR,CAFe,CAKxBX,IAAI,CAAEgC,IALkB,CAAhB,CAAL,CAMJ7B,IANI,CAMC,SAACC,QAAD,CAAc,CAClB,GAAIA,QAAQ,CAACC,MAAT,GAAoB,GAAxB,CAA6B,CACzB,KAAMC,CAAAA,KAAK,CAAC,qBAAD,CAAX,CACH,CACJ,CAVM,CAAP,CAWH,CAfM","sourcesContent":["const domain = \"http://onyx-nexus-326722.de.r.appspot.com\";\n\n// body: JSON.stringify(credential) 将登陆信息转换成json格式的string\n\nexport const login = (credential, asHost) => {\n    const loginUrl = `${domain}/authenticate/${asHost ? \"host\" : \"guest\"}`;\n    return fetch(loginUrl, {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(credential),\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to log in\");\n        }\n\n        return response.json();\n    });\n};\n\nexport const register = (credential, asHost) => {\n    const registerUrl = `${domain}/register/${asHost ? \"host\" : \"guest\"}`;\n    return fetch(registerUrl, {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(credential),\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to register\");\n        }\n    });\n};\n\nexport const getReservations = () => {\n    //local storage 浏览器提供的object\n    const authToken = localStorage.getItem(\"authToken\");\n    const listReservationsUrl = `${domain}/reservations`;\n\n    return fetch(listReservationsUrl, {\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to get reservation list\");\n        }\n\n        return response.json();\n    });\n};\n// authz authorization:进入后是什么角色\n// authn authentication: 登陆\nexport const getStaysByHost = () => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const listStaysUrl = `${domain}/stays/`;\n\n    return fetch(listStaysUrl, {\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to get stay list\");\n        }\n\n        return response.json();\n    });\n};\n\nexport const searchStays = (query) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const searchStaysUrl = new URL(`${domain}/search/`);\n    //统一后端格式\n    //如何往url上安全地增加query string的内容\n    //protocol://domain:port/path?querystring#hashtag\n    searchStaysUrl.searchParams.append(\"guest_number\", query.guest_number);\n    //format <DataPicker />所传的数据\n    searchStaysUrl.searchParams.append(\n        \"checkin_date\",\n        query.checkin_date.format(\"YYYY-MM-DD\")\n    );\n    searchStaysUrl.searchParams.append(\n        \"checkout_date\",\n        query.checkout_date.format(\"YYYY-MM-DD\")\n    );\n    searchStaysUrl.searchParams.append(\"lat\", 37);\n    searchStaysUrl.searchParams.append(\"lon\", -122);\n\n    return fetch(searchStaysUrl, {\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to search stays\");\n        }\n\n        return response.json();\n    });\n};\n\nexport const deleteStay = (stayId) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const deleteStayUrl = `${domain}/stays/${stayId}`;\n\n    return fetch(deleteStayUrl, {\n        method: \"DELETE\",\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to delete stay\");\n        }\n    });\n};\n\nexport const bookStay = (data) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const bookStayUrl = `${domain}/reservations`;\n\n    return fetch(bookStayUrl, {\n        method: \"POST\",\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n            \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(data),\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to book reservation\");\n        }\n    });\n};\n\nexport const cancelReservation = (reservationId) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const cancelReservationUrl = `${domain}/reservations/${reservationId}`;\n\n    return fetch(cancelReservationUrl, {\n        method: \"DELETE\",\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to cancel reservation\");\n        }\n    });\n};\n\nexport const getReservationsByStay = (stayId) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const getReservationByStayUrl = `${domain}/stays/reservations/${stayId}`;\n\n    return fetch(getReservationByStayUrl, {\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to get reservations by stay\");\n        }\n\n        return response.json();\n    });\n};\n\nexport const uploadStay = (data) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const uploadStayUrl = `${domain}/stays`;\n\n    return fetch(uploadStayUrl, {\n        method: \"POST\",\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n        body: data,\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to upload stay\");\n        }\n    });\n};\n"]},"metadata":{},"sourceType":"module"}