{"ast":null,"code":"const domain = \"http://onyx-nexus-326722.de.r.appspot.com:8080\"; // body: JSON.stringify(credential) 将登陆信息转换成json格式的string\n\nexport const login = (credential, asHost) => {\n  const loginUrl = `${domain}/authenticate/${asHost ? \"host\" : \"guest\"}`;\n  return fetch(loginUrl, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(credential)\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to log in\");\n    }\n\n    return response.json();\n  });\n};\nexport const register = (credential, asHost) => {\n  const registerUrl = `${domain}/register/${asHost ? \"host\" : \"guest\"}`;\n  return fetch(registerUrl, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(credential)\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to register\");\n    }\n  });\n};\nexport const getReservations = () => {\n  //local storage 浏览器提供的object\n  const authToken = localStorage.getItem(\"authToken\");\n  const listReservationsUrl = `${domain}/reservations`;\n  return fetch(listReservationsUrl, {\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    }\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to get reservation list\");\n    }\n\n    return response.json();\n  });\n}; // authz authorization:进入后是什么角色\n// authn authentication: 登陆\n\nexport const getStaysByHost = () => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const listStaysUrl = `${domain}/stays/`;\n  return fetch(listStaysUrl, {\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    }\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to get stay list\");\n    }\n\n    return response.json();\n  });\n};\nexport const searchStays = query => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const searchStaysUrl = new URL(`${domain}/search/`); //统一后端格式\n  //如何往url上安全地增加query string的内容\n  //protocol://domain:port/path?querystring#hashtag\n\n  searchStaysUrl.searchParams.append(\"guest_number\", query.guest_number); //format <DataPicker />所传的数据\n\n  searchStaysUrl.searchParams.append(\"checkin_date\", query.checkin_date.format(\"YYYY-MM-DD\"));\n  searchStaysUrl.searchParams.append(\"checkout_date\", query.checkout_date.format(\"YYYY-MM-DD\"));\n  searchStaysUrl.searchParams.append(\"lat\", 37);\n  searchStaysUrl.searchParams.append(\"lon\", -122);\n  return fetch(searchStaysUrl, {\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    }\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to search stays\");\n    }\n\n    return response.json();\n  });\n};\nexport const deleteStay = stayId => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const deleteStayUrl = `${domain}/stays/${stayId}`;\n  return fetch(deleteStayUrl, {\n    method: \"DELETE\",\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    }\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to delete stay\");\n    }\n  });\n};\nexport const bookStay = data => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const bookStayUrl = `${domain}/reservations`;\n  return fetch(bookStayUrl, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${authToken}`,\n      \"Content-Type\": \"application/json\"\n    },\n    body: JSON.stringify(data)\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to book reservation\");\n    }\n  });\n};\nexport const cancelReservation = reservationId => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const cancelReservationUrl = `${domain}/reservations/${reservationId}`;\n  return fetch(cancelReservationUrl, {\n    method: \"DELETE\",\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    }\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to cancel reservation\");\n    }\n  });\n};\nexport const getReservationsByStay = stayId => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const getReservationByStayUrl = `${domain}/stays/reservations/${stayId}`;\n  return fetch(getReservationByStayUrl, {\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    }\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to get reservations by stay\");\n    }\n\n    return response.json();\n  });\n};\nexport const uploadStay = data => {\n  const authToken = localStorage.getItem(\"authToken\");\n  const uploadStayUrl = `${domain}/stays`;\n  return fetch(uploadStayUrl, {\n    method: \"POST\",\n    headers: {\n      Authorization: `Bearer ${authToken}`\n    },\n    body: data\n  }).then(response => {\n    if (response.status !== 200) {\n      throw Error(\"Fail to upload stay\");\n    }\n  });\n};","map":{"version":3,"sources":["/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/src/utils.js"],"names":["domain","login","credential","asHost","loginUrl","fetch","method","headers","body","JSON","stringify","then","response","status","Error","json","register","registerUrl","getReservations","authToken","localStorage","getItem","listReservationsUrl","Authorization","getStaysByHost","listStaysUrl","searchStays","query","searchStaysUrl","URL","searchParams","append","guest_number","checkin_date","format","checkout_date","deleteStay","stayId","deleteStayUrl","bookStay","data","bookStayUrl","cancelReservation","reservationId","cancelReservationUrl","getReservationsByStay","getReservationByStayUrl","uploadStay","uploadStayUrl"],"mappings":"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","sourcesContent":["const domain = \"http://onyx-nexus-326722.de.r.appspot.com:8080\";\n\n// body: JSON.stringify(credential) 将登陆信息转换成json格式的string\n\nexport const login = (credential, asHost) => {\n    const loginUrl = `${domain}/authenticate/${asHost ? \"host\" : \"guest\"}`;\n    return fetch(loginUrl, {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(credential),\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to log in\");\n        }\n\n        return response.json();\n    });\n};\n\nexport const register = (credential, asHost) => {\n    const registerUrl = `${domain}/register/${asHost ? \"host\" : \"guest\"}`;\n    return fetch(registerUrl, {\n        method: \"POST\",\n        headers: {\n            \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(credential),\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to register\");\n        }\n    });\n};\n\nexport const getReservations = () => {\n    //local storage 浏览器提供的object\n    const authToken = localStorage.getItem(\"authToken\");\n    const listReservationsUrl = `${domain}/reservations`;\n\n    return fetch(listReservationsUrl, {\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to get reservation list\");\n        }\n\n        return response.json();\n    });\n};\n// authz authorization:进入后是什么角色\n// authn authentication: 登陆\nexport const getStaysByHost = () => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const listStaysUrl = `${domain}/stays/`;\n\n    return fetch(listStaysUrl, {\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to get stay list\");\n        }\n\n        return response.json();\n    });\n};\n\nexport const searchStays = (query) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const searchStaysUrl = new URL(`${domain}/search/`);\n    //统一后端格式\n    //如何往url上安全地增加query string的内容\n    //protocol://domain:port/path?querystring#hashtag\n    searchStaysUrl.searchParams.append(\"guest_number\", query.guest_number);\n    //format <DataPicker />所传的数据\n    searchStaysUrl.searchParams.append(\n        \"checkin_date\",\n        query.checkin_date.format(\"YYYY-MM-DD\")\n    );\n    searchStaysUrl.searchParams.append(\n        \"checkout_date\",\n        query.checkout_date.format(\"YYYY-MM-DD\")\n    );\n    searchStaysUrl.searchParams.append(\"lat\", 37);\n    searchStaysUrl.searchParams.append(\"lon\", -122);\n\n    return fetch(searchStaysUrl, {\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to search stays\");\n        }\n\n        return response.json();\n    });\n};\n\nexport const deleteStay = (stayId) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const deleteStayUrl = `${domain}/stays/${stayId}`;\n\n    return fetch(deleteStayUrl, {\n        method: \"DELETE\",\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to delete stay\");\n        }\n    });\n};\n\nexport const bookStay = (data) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const bookStayUrl = `${domain}/reservations`;\n\n    return fetch(bookStayUrl, {\n        method: \"POST\",\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n            \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify(data),\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to book reservation\");\n        }\n    });\n};\n\nexport const cancelReservation = (reservationId) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const cancelReservationUrl = `${domain}/reservations/${reservationId}`;\n\n    return fetch(cancelReservationUrl, {\n        method: \"DELETE\",\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to cancel reservation\");\n        }\n    });\n};\n\nexport const getReservationsByStay = (stayId) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const getReservationByStayUrl = `${domain}/stays/reservations/${stayId}`;\n\n    return fetch(getReservationByStayUrl, {\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to get reservations by stay\");\n        }\n\n        return response.json();\n    });\n};\n\nexport const uploadStay = (data) => {\n    const authToken = localStorage.getItem(\"authToken\");\n    const uploadStayUrl = `${domain}/stays`;\n\n    return fetch(uploadStayUrl, {\n        method: \"POST\",\n        headers: {\n            Authorization: `Bearer ${authToken}`,\n        },\n        body: data,\n    }).then((response) => {\n        if (response.status !== 200) {\n            throw Error(\"Fail to upload stay\");\n        }\n    });\n};\n"]},"metadata":{},"sourceType":"module"}