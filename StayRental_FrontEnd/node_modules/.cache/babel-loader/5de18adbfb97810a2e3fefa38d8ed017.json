{"ast":null,"code":"var _jsxFileName = \"/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/src/components/LoginPage.js\";\nimport React from \"react\";\nimport { Form, Button, Input, Space, Checkbox, message } from \"antd\";\nimport { UserOutlined } from \"@ant-design/icons\";\nimport { login, register } from \"../utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass LoginPage extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.formRef = /*#__PURE__*/React.createRef();\n    this.state = {\n      asHost: false,\n      loading: false\n    };\n\n    this.onFinish = () => {\n      console.log(\"finish form\");\n    };\n\n    this.handleLogin = async () => {\n      const formInstance = this.formRef.current;\n\n      try {\n        await formInstance.validateFields();\n      } catch (error) {\n        return;\n      }\n\n      this.setState({\n        loading: true\n      });\n\n      try {\n        const {\n          asHost\n        } = this.state; //formInstance.getFieldsValue(true)， 从当前instance取出值\n\n        const resp = await login(formInstance.getFieldsValue(true), asHost); //登陆成功后，parent的component通过props做的事情\n        //记录token，确认一下authority是否是host\n\n        this.props.handleLoginSuccess(resp.token, asHost);\n      } catch (error) {\n        message.error(error.message);\n      } finally {\n        this.setState({\n          loading: false\n        });\n      }\n    };\n\n    this.handleRegister = async () => {\n      const formInstance = this.formRef.current; //在前端中检查\n\n      try {\n        await formInstance.validateFields();\n      } catch (error) {\n        return;\n      } //前端的validation通过\n\n\n      this.setState({\n        loading: true\n      });\n\n      try {\n        await register(formInstance.getFieldsValue(true), this.state.asHost);\n        message.success(\"Register Successfully\");\n      } catch (error) {\n        message.error(error.message);\n      } finally {\n        this.setState({\n          loading: false\n        });\n      }\n    };\n\n    this.handleCheckboxOnChange = e => {\n      this.setState({\n        asHost: e.target.checked\n      });\n    };\n  }\n\n  //onfish事件会在form提交时触发\n  // 绑定formRef\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        width: 500,\n        margin: \"20px auto\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(Form, {\n        ref: this.formRef,\n        onFinish: this.onFinish,\n        children: [/*#__PURE__*/_jsxDEV(Form.Item, {\n          name: \"username\",\n          rules: [{\n            required: true,\n            message: \"Please input your Username!\"\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            disabled: this.state.loading,\n            prefix: /*#__PURE__*/_jsxDEV(UserOutlined, {\n              className: \"site-form-item-icon\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 95,\n              columnNumber: 37\n            }, this),\n            placeholder: \"Username\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Form.Item, {\n          name: \"password\",\n          rules: [{\n            required: true,\n            message: \"Please input your Password!\"\n          }],\n          children: /*#__PURE__*/_jsxDEV(Input.Password, {\n            disabled: this.state.loading,\n            placeholder: \"Password\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 108,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Space, {\n        children: [/*#__PURE__*/_jsxDEV(Checkbox, {\n          disabled: this.state.loading,\n          checked: this.state.asHost,\n          onChange: this.handleCheckboxOnChange,\n          children: \"As Host\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleLogin,\n          disabled: this.state.loading,\n          shape: \"round\",\n          type: \"primary\",\n          children: \"Log in\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 122,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          onClick: this.handleRegister,\n          disabled: this.state.loading,\n          shape: \"round\",\n          type: \"primary\",\n          children: \"Register\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 13\n    }, this);\n  }\n\n}\n\nexport default LoginPage;","map":{"version":3,"sources":["/Users/sihui/Documents/SDE_Learning/staybooking-app/staybooking-app/src/components/LoginPage.js"],"names":["React","Form","Button","Input","Space","Checkbox","message","UserOutlined","login","register","LoginPage","Component","formRef","createRef","state","asHost","loading","onFinish","console","log","handleLogin","formInstance","current","validateFields","error","setState","resp","getFieldsValue","props","handleLoginSuccess","token","handleRegister","success","handleCheckboxOnChange","e","target","checked","render","width","margin","required"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Form, Button, Input, Space, Checkbox, message } from \"antd\";\nimport { UserOutlined } from \"@ant-design/icons\";\nimport { login, register } from \"../utils\";\n\nclass LoginPage extends React.Component {\n    //初始化formRef\n    formRef = React.createRef();\n    state = {\n        asHost: false,\n        loading: false,\n    };\n\n    onFinish = () => {\n        console.log(\"finish form\");\n    };\n\n    handleLogin = async () => {\n        const formInstance = this.formRef.current;\n\n        try {\n            await formInstance.validateFields();\n        } catch (error) {\n            return;\n        }\n\n        this.setState({\n            loading: true,\n        });\n\n        try {\n            const { asHost } = this.state;\n            //formInstance.getFieldsValue(true)， 从当前instance取出值\n            const resp = await login(formInstance.getFieldsValue(true), asHost);\n            //登陆成功后，parent的component通过props做的事情\n            //记录token，确认一下authority是否是host\n            this.props.handleLoginSuccess(resp.token, asHost);\n        } catch (error) {\n            message.error(error.message);\n        } finally {\n            this.setState({\n                loading: false,\n            });\n        }\n    };\n\n    handleRegister = async () => {\n        const formInstance = this.formRef.current;\n        //在前端中检查\n        try {\n            await formInstance.validateFields();\n        } catch (error) {\n            return;\n        }\n        //前端的validation通过\n        this.setState({\n            loading: true,\n        });\n\n        try {\n            await register(formInstance.getFieldsValue(true), this.state.asHost);\n            message.success(\"Register Successfully\");\n        } catch (error) {\n            message.error(error.message);\n        } finally {\n            this.setState({\n                loading: false,\n            });\n        }\n    };\n\n    handleCheckboxOnChange = (e) => {\n        this.setState({\n            asHost: e.target.checked,\n        });\n    };\n\n//onfish事件会在form提交时触发\n// 绑定formRef\n    render() {\n        return (\n            <div style={{ width: 500, margin: \"20px auto\" }}>\n                <Form ref={this.formRef} onFinish={this.onFinish}>\n                    <Form.Item\n                        name=\"username\"\n                        rules={[\n                            {\n                                required: true,\n                                message: \"Please input your Username!\",\n                            },\n                        ]}\n                    >\n                        <Input\n                            disabled={this.state.loading}\n                            prefix={<UserOutlined className=\"site-form-item-icon\" />}\n                            placeholder=\"Username\"\n                        />\n                    </Form.Item>\n                    <Form.Item\n                        name=\"password\"\n                        rules={[\n                            {\n                                required: true,\n                                message: \"Please input your Password!\",\n                            },\n                        ]}\n                    >\n                        <Input.Password\n                            disabled={this.state.loading}\n                            placeholder=\"Password\"\n                        />\n                    </Form.Item>\n                </Form>\n                <Space>\n                    <Checkbox\n                        disabled={this.state.loading}\n                        checked={this.state.asHost}\n                        onChange={this.handleCheckboxOnChange}\n                    >\n                        As Host\n                    </Checkbox>\n                    <Button\n                        onClick={this.handleLogin}\n                        disabled={this.state.loading}\n                        shape=\"round\"\n                        type=\"primary\"\n                    >\n                        Log in\n                    </Button>\n                    <Button\n                        onClick={this.handleRegister}\n                        disabled={this.state.loading}\n                        shape=\"round\"\n                        type=\"primary\"\n                    >\n                        Register\n                    </Button>\n                </Space>\n            </div>\n        );\n    }\n}\n\nexport default LoginPage;\n"]},"metadata":{},"sourceType":"module"}